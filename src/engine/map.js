// üìÅ src/engine/map.js

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)
export const map = {
  width: 1000,
  height: 700,
  tilesize: 40,
  walls: [
    // –í–Ω–µ—à–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ä—Ç—ã
    { x: 50,  y: 50,  w: 880, h: 20 },
    { x: 50,  y: 610, w: 880, h: 20 },
    { x: 50,  y: 50,  w: 20,  h: 560 },
    { x: 930, y: 50,  w: 20,  h: 560 },

    // –õ–µ–≤–∞—è —Å—Ç–µ–Ω–∞ "—Ç—É–Ω–Ω–µ–ª–µ–π" (–¥–æ B site)
    { x: 300, y: 50,  w: 20,  h: 510 },

    // –ü—Ä–∞–≤–∞—è —Å—Ç–µ–Ω–∞ "–ª–æ–Ω–≥–∞" (–¥–æ A site)
    { x: 700, y: 50,  w: 20,  h: 510 }
  ],
  loot: [
    { id: 'crate',     x: 160, y: 80 },   // –¢–æ—á–∫–∞ B
    { id: 'ammo_box',  x: 840, y: 80 }    // –¢–æ—á–∫–∞ A
  ]
};

// –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∫–∞—Ä—Ç—ã
export function drawMap(ctx) {
  ctx.fillStyle = '#444';
  for (const wall of map.walls) {
    ctx.fillRect(wall.x, wall.y, wall.w, wall.h);
  }

  for (const item of map.loot) {
    ctx.fillStyle = (item.id === 'medkit') ? '#f00'
                  : (item.id === 'crate') ? '#888'
                  : '#0af';
    ctx.fillRect(item.x - 10, item.y - 10, 20, 20);
  }
}

// –ï—Å–ª–∏ –∫–∞—Ä—Ç–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, —ç—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è
export let activeMap = map;

// –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑—á–∏–∫—É —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É
export function setActiveMap(newMap) {
  activeMap = newMap;
}